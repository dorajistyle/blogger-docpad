---
layout: IT
title: Perl Script로 CSV다루기
date: '2011-10-23'
comments: true
adsense: true
ignored: false
tags:
- csv
- IT
- Perl
- tip
- "스크립트"
---

<div id="hreview-summary" class="hreview"><h2 id="article_summary" class="summary">Perl Script로 CSV다루는 방법입니다.</h2><div class="item"><span class="fn">Perl Script로 CSV다루기</span></div><p><span class="description"><img class="photo" src="http://i786.photobucket.com/albums/yy144/dorajistyle/Captures%20for%20posting/PerlApp_CSV01.jpg" alt="Perl Dev Kit-'Perl Script로 CSV다루기'" width="468" height="678" /></p><p>펄 스크립트용 CSV 모듈로 Text-CSV가 있습니다.</p><p>액티브 펄을 사용 중이라면 PPM(Perl Package Manager)를 이용해 다음과 같은 방법으로 모듈을 추가할 수 있죠.</p><p><strong>PPM install Text-CSV_XS</strong></p><p>그런데 저는 Text-CSV_XS 패키지 설치가 안 되더군요.</p><p>그래서 좀 지난 버전을 설치해보니 잘 깔립니다.</p><p><strong>PPM install Text-CSV</strong></p><p>그런데 자꾸만 TEXT-CSV_PP 파일을 찾을 수 없다는 오류가 나네요.</p><p>인터넷에서 검색을 해보니 환경변수에 다음을 추가해 주면 잘 작동한다고 합니다.</p><p>PERL5LIB=C:\Perl\site\lib;C:\Perl\lib;</p><p>하지만 안되는군요.</p><p>개발시간의 태반은 설계가 잡아먹고,<br />모듈 설치다 뭐다 환경 설정이 20%를 가져가면,<br />코딩하는 시간은 10% 정도밖에 안 되는 것 같습니다.</p><p>아래 링크에서 Text-CSV_XS 소스를 직접 받아서 펄 라이브러리 폴더<strong><span style="color: #3366ff;">(C:\Perl\site\lib</span></strong>)에 넣었어요.</p><p><span style="font-size: large;"><strong><a title="CSV XS" href="http://search.cpan.org/dist/Text-CSV_XS/CSV_XS.pm" target="_blank">CPAN CSV_XS.PM</a> </strong></span></p><p>사용 방법도 잘 설명되어 있죠.</p><p><strong><span style="color: #ff0000;">CSV_XS ERROR: 2023 - EIQ - QUO character not allowed</span></strong></p><p>혹시 위와 같은 에러가 난다면 new 할 때 아래의 속성을 추가해 보세요.</p><p>allow<em>loose</em>quotes =&gt; 1<br />escape_char =&gt; undef</p><p>아래코드는 간단하게 작성해 본 예제에요.</p><p><hr/></p>!/usr/bin/perl<br /><p>use Text::CSV_XS;</p><p>if ( @ARGV &gt; 1 ){&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp; my $input = @ARGV[0];<br />&nbsp;&nbsp;&nbsp; my $output = @ARGV[1];<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp; my $csv = <strong>Text::CSV<em>XS-&gt;new ({ binary =&gt; 1, allow</em>loose<em>quotes =&gt; 1,escape</em>char =&gt; undef })</strong> or<br />&nbsp;&nbsp;&nbsp;&nbsp; die "Cannot use CSV: ".Text::CSV<em>XS-&gt;error</em>diag ();<br />&nbsp;&nbsp;&nbsp; open my $fh, "&lt;:encoding(utf8)", $input or die $input.": $!";<br />&nbsp;&nbsp;&nbsp; my $column<em>name = $csv-&gt;column</em>names ($csv-&gt;getline ($fh));<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp; while (my $row = $csv-&gt;getline ($fh)) {<br />&nbsp;&nbsp;&nbsp; print("size = $column<em>name\n");<br />&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp; for $n (0 .. $column</em>name) {<br />&nbsp;&nbsp;&nbsp; &nbsp; $column = $row -&gt; [$n];<br />&nbsp;&nbsp;&nbsp; &nbsp; $row -&gt; [$n] = $column;<br />&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp;&nbsp; push @rows, $row;<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;$csv-&gt;eof or $csv-&gt;error_diag ();<br />&nbsp;close $fh;</p><p>&nbsp;$csv-&gt;eol ("\n");<br />&nbsp;open $fh, "&gt;:encoding(utf8)", $output or die $output.": $!";<br />&nbsp;$csv-&gt;print ($fh, $_) for @rows;<br />&nbsp;close $fh or die $output.": $!";<br />}else {<br />&nbsp; print "No Arguments!\n";&nbsp;&nbsp;<br />}</p><p><hr/></p><p></span>by <span class="reviewer vcard"><a class="url fn" title="월풍도원(月風道院) 소개" href="http://www.dorajistyle.pe.kr/p/%EB%B8%94%EB%A1%9C%EA%B7%B8%EC%86%8C%EA%B0%9C-%EC%9B%94%ED%92%8D%EB%8F%84%EC%9B%90%E6%9C%88%E9%A2%A8%E9%81%93%E9%99%A2-delight-on-simple-life.html" target="_blank">月風</a></span></div></p>

---
layout: IT
title: "인터넷 익스플로러(IE) 9이하에서  CORS 설정"
date: '2014-05-23'
comments: true
adsense: true
ignored: true
tags:
- browser
- cors
- cross domain
- development
- ie
- internet explorer
- IT
- web
---

<h2 id="article_summary" class="summary">인터넷 익스플로러 9 이하에서 CORS(Cross-origin resource sharing) 설정.</h2><p>정적인(static) 파일은 보통 CDN(Contents Delivery Network)과 연결하여 사용자에게 빠르게 전달한다.<br />사용자 입장에선 빠르게 콘텐츠를 받아볼 수 있어 좋고,<br />관리자 입장에선 서버에 부담을 줄여줘서 좋다.<br />그러나 외부 CDN을 이용할 땐 주의해야 한다.<br />인터넷 익스플로러 대마왕이 CDN을 편히 쓰도록 가만히 놔두질 않기 때문이다.<br />만약 스타일 시트를 CDN에 올려놨다면, 인터넷 익스플로러에서 처참하게 망가진 화면을 만나게 될 것이고,<br />Ajax로 CDN 서버에 요청을 한다면 404 오류코드(파일은 내가 처리했다. 다음은 너 차레야라는 뜻.)를 만나게 된다.<br />이것은 재앙이며, 개발자에겐 악몽을 선사한다.</p><p>우리나라는 1999년 전자서명법을 시행하면서 액티브X를 중심으로 하는 공인인증제가 도입됐다.<br />이것이 인터넷 익스플로러 대마왕의 힘을 키워준 것이 되었고,<br />웹 개발자(특히 한국 개발자)는 새천년 밀레니엄의 시작과 함께 인터넷 익스플로러 대마왕과 힘겨운 싸움을 이어와야 했다.<br />최근에는 인터넷 익스플로러에서 보안 결함이 발견되어 영국과 미국 정부에서 인터넷 익스플로러를 쓰지 말라는 권고를 내리기도 했었다.<br />(<a href="http://www.telegraph.co.uk/technology/microsoft/10793272/Dont-use-Internet-Explorer-warns-US-government.html" target="_blank">http://www.telegraph.co.uk/technology/microsoft/10793272/Dont-use-Internet-Explorer-warns-US-government.html</a>)<br />물론 이 문제가 패치 되긴 했지만(<a href="http://techcrunch.com/2014/05/01/microsoft-patches-latest-internet-explorer-security-flaw-even-for-xp-users" target="_blank">http://techcrunch.com/2014/05/01/microsoft-patches-latest-internet-explorer-security-flaw-even-for-xp-users</a>),<br />인터넷 익스플로러는 여전히 골칫거리여서,<br />'인터넷 익스플로러 쓰지 마세요.'(<a href="http://donotuseie.com" target="_blank">http://donotuseie.com</a>)라는 사이트가 있을 정도다.</p><p>마음 같아서는 인터넷 익스플로러를 무시하고 개발하고 싶다.<br />그러나, 한국에선 인터넷 익스플로러가 갑이다.<br />인터넷 익스플로러에서만 돌아가는 웹사이트가 수두룩하기 때문이다.<br />'한국 사람들은 인터넷 익스플로러를 써요. 법이거든요.'(<a href="http://www.zdnet.com/south-koreans-use-internet-explorer-its-the-law-7000022827" target="_blank">http://www.zdnet.com/south-koreans-use-internet-explorer-its-the-law-7000022827</a>)라는 기사에서도 볼 수 있듯,<br />우리나라는 인터넷 익스플로러 사용자 인구가 많다.<br />게다가 10부터는 그나마 좀 나은데, 우리나라는 8을 제일 많이 쓴다.<br />statcounter 작년 5월부터 올해 5월까지 통계를 뽑아보니 한숨이 나온다.</p><p><a href="https://farm3.staticflickr.com/2904/14249260294_ea7c4ac61c_o.jpg"><img class="photo" src="https://farm3.staticflickr.com/2904/14249260294_ea7c4ac61c_o.jpg" alt="브라우저 이용 현황, 한국-'인터넷 익스플로러(IE) 9이하에서  CORS 설정'" width="640" height="413" /></a></p><p>그럼 전 세계적으로는 어떤 브라우저를 많이 쓸까?</p><p><a href="https://farm6.staticflickr.com/5546/14246290691_077ffbc59f_o.jpg"><img class="photo" src="https://farm6.staticflickr.com/5546/14246290691_077ffbc59f_o.jpg" alt="브라우저 이용 현황, 전세계-'인터넷 익스플로러(IE) 9이하에서  CORS 설정'" width="640" height="413" /></a></p><p>크롬이 압도적이고, 다음은 파이어폭스다.<br />하지만 한국의 개발자가 웹 어플리케이션을 만들려면, IE8 이상은 지원해야 된다.<br />대한민국은 인터넷 익스플로러 강국이니까.</p><h3>인터넷 익스플로러(IE) 9이하에서 CORS 설정.</h3><p>CDN서버에 CORS 설정을 해 두고, 아래 코드를 적용하면 된다.</p><p>우선 CSS를 제대로 보여주기 위한 Respond.js 설정이다.</p><h4>마크업</h4><p>여기에서 static_path는 CDN서버의 주소이다.<br /><code>&lt;!DOCTYPE html&gt;<br />...<br />&lt;html&gt;&lt;head&gt;<br />&lt;!--[if lt IE 9]&gt;&lt;&gt;<br />&lt;script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"&gt;&lt;/script&gt;<br />&lt;script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;<br />&lt;link href="#{static_path}/js/vendor/respond-proxy.html" id="respond-proxy", rel="respond-proxy"&gt;<br />&lt;link href="/ie/respond/respond.proxy.gif" id="respond-redirect", rel="respond-redirect"&gt;<br />&lt;script src="/ie/respond/respond.proxy.js"&gt;&lt;/script&gt;<br />&lt;![endif]--&gt;&lt;/head&gt;...&lt;/html&gt;<br /></code><br /><br /><h4>서버단 flask</h4><p>/ie로 요청이 들어오면, 어플리케이션의 루트안에 ie폴더에서 파일을 찾아 응답한다.<br /><code>@app.route('/ie/')<br />def base_static(filename):<br />print('app root path '+str(app.root_path))<br />print('app filename '+str(filename))<br />return send_from_directory(app.root_path + '/ie/', filename)</code></p><p>그리고 jQuery ajaxTransport XDomainRequest(<a href="https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest" target="_blank">https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest</a>)를 다운받아 jquery 다음에 불러 놓으면,<br />인터넷 익스플로러에서 자동으로 CORS처리를 해준다. 내겐 이게 제일 간편하고 좋았다.</p><p>인터넷 익스플로러의 횡포가 계속된다면 '한국에서 인터넷 익스플로러를 무찌를 레이드 파티 구합니다.'라는 공고가 올라올지도...?</p><h3>참조</h3><ul><li><a href="http://gs.statcounter.com/#all-browser_version_partially_combined-KR-monthly-201305-201405-bar" target="_blank">http://gs.statcounter.com/#all-browser_version_partially_combined-KR-monthly-201305-201405-bar</a></li><li><a href="http://gs.statcounter.com/#all-browser_version_partially_combined-ww-monthly-201305-201405-bar" target="_blank">http://gs.statcounter.com/#all-browser_version_partially_combined-ww-monthly-201305-201405-bar</a></li><li><a href="http://www.w3schools.com/browsers/browsers_stats.asp" target="_blank">http://www.w3schools.com/browsers/browsers_stats.asp</a></li><li><a href="http://blog.gauffin.org/2014/04/how-to-use-cors-requests-in-internet-explorer-9-and-below" target="_blank">http://blog.gauffin.org/2014/04/how-to-use-cors-requests-in-internet-explorer-9-and-below</a></li><li><a href="https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest" target="_blank">https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest</a></li><li><a href="https://github.com/jpillora/xdomain" target="_blank">https://github.com/jpillora/xdomain</a></li><li><a href="https://github.com/scottjehl/Respond" target="_blank">https://github.com/scottjehl/Respond</a></li><li><a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank">http://en.wikipedia.org/wiki/Cross-origin_resource_sharing</a></li><li><a href="https://gist.github.com/rduplain/2758737" target="_blank">https://gist.github.com/rduplain/2758737</a></li></ul>

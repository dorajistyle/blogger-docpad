---
layout: IT
title: Perl에서  Jquery를 이용해 email 중복 검사 하기
date: '2011-10-19'
comments: true
adsense: true
ignored: true
tags:
- Ajax
- IT
- jquery
- Perl
- web
---

<div id="hreview-summary" class="hreview"><h2 class="summary" id="article_summary">Perl에서 Jquery를 이용해 email 중복을 검사하는 방법입니다.</h2><div class="item"><span class="fn">Perl에서  Jquery를 이용해 email 중복 검사 하기</span></div><p><span class="description"><a title="Code review By Richard Masoner / Cyclelicious" rel="bookmark" href="http://www.flickr.com/photos/bike/4299152140/" target="_blank"><img class="photo" src="http://farm5.static.flickr.com/4038/4299152140_9a860a1ac1.jpg" alt="-'Perl에서  Jquery를 이용한 email 중복체크 하기'" width="473" height="500" /></a></p><p>저는 이번에 Perl을 처음 건드려 봅니다.<br />'펄 세계엔, 한줄의 코드로 컴퓨터를 주므르는 고수들이 살고 있다!'<br />한참 전에 이런 소리를 들어 봤던거 같군요.<br />그때 든 생각은.<br />'한줄? 아! 디버깅하기 힘들겠구나.' 였어요.<br />인간 친화적이라기보다 기계 친화적인 언어라고 생각했었죠.<br />펄로 만들어진 PHP는 친숙하지만 Perl이라면 왠지 거리감이 느껴지는 언어였어요.<br />그런데 Perl에서도 요즘 흔히 쓰는 Jquery를 이용한 Ajax 구현이 가능합니다.<br />덕분에 조금 가까워 졌네요.:D</p><p><hr/><span style="color: #0000ff; font-size: large;"><strong>duplicate_test.html</strong></span><br />&lt;html&gt;&lt;head/&gt;&lt;body&gt;<br />&lt;INPUT maxLength=12 name="email" id="email" size="20"&gt;&lt;br/&gt;</p><p>&lt;div id="duplicateResult"&gt;&lt;/div&gt;<br />&lt;script type="text/javascript" src="/rfo/jquery.js"&gt;&lt;/script&gt;</p><p>&lt;script type="text/javascript" src="/rfo/duplicate.js"&gt;&lt;/script&gt;<br />&lt;/body&gt;&lt;/html&gt;</p><hr/><p><span style="font-size: large; color: #0000ff;"><strong>duplicate.js</strong></span><br />$(document).ready(function(){<br />&nbsp; $("#email").keyup(function() {<br />&nbsp;&nbsp;&nbsp; var email = $('#email').attr('value'); // get email<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (email) { // values are not empty&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $.ajax({<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type: "GET",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; url: "/cgi-bin/duplicate.pl", // URL of the Perl script<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contentType: "application/json; charset=utf-8",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dataType: "json",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data: "email=" + email,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // script call was <em>not</em> successful<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error: function(XMLHttpRequest, textStatus, errorThrown) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').text("responseText: " + XMLHttpRequest.responseText<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + ", textStatus: " + textStatus<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + ", errorThrown: " + errorThrown);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').addClass("error");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }, // error<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // script call was successful<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // data contains the JSON values returned by the Perl script<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; success: function(data){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data.vacancy) { // script returned error<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').html("&lt;span style='color:blue;font-size:14px;font-weight:bold;'&gt;" + data.vacancy+"&lt;/span&gt;");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').addClass("vacancy");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } // if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else { // login was successful<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').html("&lt;span style='color:red;font-size:14px;font-weight:bold;'&gt;" + data.occupied+"&lt;/span&gt;");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').addClass("occupied");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } // success<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }); // ajax<br />&nbsp;&nbsp;&nbsp; } // if<br />&nbsp;&nbsp;&nbsp; else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').text("아이디를 입력해 주세요.");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $('div#duplicateResult').addClass("error");<br />&nbsp;&nbsp;&nbsp; } // else<br />&nbsp;&nbsp;&nbsp; $('div#duplicateResult').fadeIn();<br />&nbsp;&nbsp;&nbsp; return false;<br />&nbsp; });<br />});</p><hr/><p><span style="font-size: large; color: #0000ff;"><strong>duplicate.pl</strong></span></p>!/usr/bin/perl<br /><p>use CGI;<br />use DBI;<br />use strict;<br />use warnings;<br />use rfoconfig;</p><br />read the CGI params<br /><p>my $cgi = CGI-&gt;new;<br />my $email = $cgi-&gt;param("email");</p><br />connect to the database<br /><p>my $dbh = DBI-&gt;connect("DBI:mysql:testDB:localhost","user","password");</p><br />check the username and password in the database<br /><p>my $statement = qq{SELECT COUNT(*) FROM user WHERE email=?};<br />my $sth = $dbh-&gt;prepare($statement)&nbsp; or die $dbh-&gt;errstr;<br />$sth-&gt;execute($email)&nbsp; or die $sth-&gt;errstr;<br />my ($duplicate<em>key) = $sth-&gt;fetchrow</em>array;</p><p>my $json = ($duplicate_key) ?<br />&nbsp; qq{{"occupied" : " $email는 이미 있는 아이디 입니다."}} :<br />&nbsp; qq{{"vacancy" : "$email을 사용하실 수 있습니다."}};</p><br />return JSON string<br /><br /><hr/><i>"DBI:mysql:testDB:localhost","user","password"</i><br />우선 위 코드에서 testDB:localhost , user, password는 테스트 환경에 맞게 설정해 주세요.<br /><p>print $cgi-&gt;header(-type =&gt; "application/json", -charset =&gt; "utf-8");<br />print $json;<br />아래 파일은 Document root/ 에 넣으세요.</p><ul><li>Jquery.js (<a title="Jquery" rel="bookmark" href="http://jquery.com" target="_blank">http://jquery.com</a> 에서 다운로드 받으세요.)</li><li>duplicate.js</li><li>duplicate_test.html</li></ul><p>아래 파일은 Document root/cgi-bin 에 넣으세요.</p><ul><li>duplicate.pl</li></ul><br /><br /><p>&nbsp;</p><p><strong>참고자료</strong><br /><strong><span style="font-size: medium;"><a title="Very simple login using Perl, jQuery, Ajax, JSON and MySQL" rel="bookmark" href="http://www.ibm.com/developerworks/webservices/library/ws-simplelogin/index.html?ca=drs-" target="_blank">Very simple login using Perl, jQuery, Ajax, JSON and MySQL</a><br /></span></strong><br /></span>by <span class="reviewer vcard"><a class="url fn" title="월풍도원(月風道院) 소개" href="http://www.dorajistyle.pe.kr/p/%EB%B8%94%EB%A1%9C%EA%B7%B8%EC%86%8C%EA%B0%9C-%EC%9B%94%ED%92%8D%EB%8F%84%EC%9B%90%E6%9C%88%E9%A2%A8%E9%81%93%E9%99%A2-delight-on-simple-life.html" target="_blank">月風</a></span></div></p>
